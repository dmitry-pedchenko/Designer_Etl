# Графический интерфейс загрузчика
## Описание приложения

Данное приложение выполнено в виде графического интерфейса, созданного для удобства использования системы загрузки.
Данное руководство служит как дополнение для основного руководства, которое находитися в файле readme.md. Описание настроек
системы и способы настроек находятся в основном руководстве, в данном файле находится только описание применения графического
интерфейса.
## Оглавление

1. [Установка тебуемых пакетов](#Установка-тебуемых-пакетов)
2. [Информация о структуре проекта](#Информация-о-структуре-проекта)
2. [Сборка пакета в exe файл](#Сборка-пакета-в-exe-файл)
4. [Изменение языка системы](#Изменение-языка-системы)
5. [Запуск системы](#Запуск-системы)


## Установка тебуемых пакетов

Для установки требуемых пакетов выполните в консоли следующие команды: 
```
pip install pyqt5
```
[:arrow_up:Оглавление](#Оглавление)

## Информация о структуре проекта

В структуру проекта входят пакеты описанные ранне в основном файле описания системы, а так же новый пакет,
отвечающий за графическое оформление `GUI`
Он имеет следующую структуру:

- GUI
    - Creators
    - DAO
    - gui_qt
    - System
    - System
    - Trees
    - Windows
    - `gui_main_interface.py`
    
`Creators` В данном пакете находятся функции создания компонентов интерфейса
`DAO` в даном пакете находятся инструменты доступа к данным и создания файлов
`gui_qt` В данном пакете находятся файлы интерфейсов, созданные при помощи QT Desigener а также 
скрипты конвертирования их в файлы с расширением `.py`

`System` в данном пакете находятся файлы настроек системы. В частности настройка языка интерфейса
`Trees` в данном пакете находятся классы объектов интерфейса имеющие древесную структуру
`Windows` в данном пакете находятся объекты интерфейса представляющие собой окна программы.
`gui_main_interface.py` данный скрипт является основным скриптом запуска системы
[:arrow_up:Оглавление](#Оглавление)
## Сборка пакета в exe файл

ВАЖНО: сборка пакета под Windows осуществляется только из под ОС Windows

Для того чтобы появилась возможность запуска проекта из `.exe`файла нужно выполнить, находясь
в корневой директории следующее:

В файле `Core/Logger/Logger.py` в строке 184 строчку:

```python
if os.path.basename(sys.argv[0]) != 'gui_main_interface.py': 
```

нужно заменить на:

```python
if os.path.basename(sys.argv[0]) != 'gui_main_interface.exe': 
```

и затем, находясь в корневой директории, выполнить в командной строке следующее:

```bash
pyinstaller --noconsole --onefile --icon=icon.ico GUI/gui_main_interface.py
```

В результате появится директория dist, в которой находится собранный пакет 

`gui_main_interface.exe`

В директорию dist необходимо скопировать из директории `GUI` следующие диреткории вместе с содержимым:
- Source
- config
- System (только файлы `config.json` и `lan_config.xml` )
- log

т.е. папка с проектом будет выглядеть следующим образом

<image src="readme/open/dir.png">

[:arrow_up:Оглавление](#Оглавление)
## Изменение языка системы
 
Для изменения языка системы нужно выполнить следующее:

- Закрыть программу
- В файле `GUI/System/config.json` в разделе "language" значение поставить либо `sys` либо `rus`
- Открыть программу

Значение языка автоматически применится

`sys` устанавливает значения полей в системных переменных (как это описано в основном описании системы).

`rus` устанавливает язык интерфейса в русский язык.

По умолчанию стоит русский язык.

[:arrow_up:Оглавление](#Оглавление)
## Запуск системы

Для запуска системы нужно выполнить следующие действия:

- Находясь в коренвой директории в консоле выполнить
```bash
python GUI/gui_main_interface.py
```

Или, если собран пакет .exe , то запустить `gui_main_interface.exe`

[:arrow_up:Оглавление](#Оглавление)
## Описание загрузки

В данном руководстве будет выполнения следующая загрузка: в целевой таблице в базе данных 
MSSQL будет выполнена загрузка в три таблицы `Table_1` `Table_2` `Table`
Конфигурации таблиц следующие:

`Table_1`
<image src="readme/open/Table_1.png">


`Table_2`
<image src="readme/open/Table_2.png">


`Table`
<image src="readme/open/Table.png">

Таблицы `Table_1` и `Table_2` связаны с таблицей `Table` полями `Table_1.id` `Table_2.id` с полями
`Table.id_1` `Table.id_2` посредством внешних ключей 

В качестве источника имеется два Excel файла 

`loc_test_dic.xlsx`
<image src="readme/Load/loc_test_dic.png">

`Book.xlsx`
<image src="readme/Load/book.png">

Файл `Book.xlsx` служит для демонстрации операции сравнения двух файлов.

[:arrow_up:Оглавление](#Оглавление)
## Открытие файла конфигурации

Для открытия файла нужно выполнить следующие действия:
В основном окне приложения открыть в верхней части раздел `File/Open` и в появившемся окне выбрать
нужный файл конфигурации. Во время открытия будет следующий вид программы:

<image src="readme/open/open_connect.png">

сообщающее о том что идет процесс открытия файла конфигурации.
Когда файл загрузится в систему, вы увидите следующий вид:

<image src="readme/open/opened.png">

Сообщеющий в нижней части окна о том к какой базе данных осуществлено подключение в соответствии с
настройками в конфигурации, а так же имя конфигурации, показанное в заголовке главного окна системы.

Данный процесс выглядит следующим образом:

<image src="readme/open/open_config.gif">

Если же процесс не может выполнится по каким-то причинам то будет отобрадено всплывающее окно с ошибкой:

<image src="readme/open/open_error.png">

Если ошибка появилась, то рекомендую проверить файл конфигурации на корректность имен полей, типов данных,и настроек базы данных
 открыв его любым текстовым редатором.
 
 




